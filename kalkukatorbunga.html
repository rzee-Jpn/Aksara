<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kalkulator Cicilan Detail</title>

  <style>
    :root {
      --bg: #f5f5f5;
      --card: #ffffff;
      --text: #222;
      --primary: #0077ff;
    }
    .dark {
      --bg: #121212;
      --card: #1f1f1f;
      --text: #eaeaea;
      --primary: #4ea2ff;
    }
    body {
      margin: 0;
      padding: 20px;
      background: var(--bg);
      color: var(--text);
      font-family: Poppins, Arial;
    }
    .container {
      max-width: 750px;
      margin: auto;
      background: var(--card);
      padding: 25px;
      border-radius: 14px;
      box-shadow: 0 2px 20px rgba(0,0,0,0.1);
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-bottom: 12px;
      border-radius: 8px;
      border: 1px solid #ccc;
      background: var(--card);
      color: var(--text);
    }
    button {
      width: 100%;
      padding: 12px;
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
    }
    .toggle {
      background: none;
      border: none;
      color: var(--text);
      font-size: 18px;
      cursor: pointer;
      margin-bottom: 15px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      font-size: 14px;
    }
    th, td {
      padding: 6px;
      text-align: center;
      border-bottom: 1px solid #ddd;
    }
    th {
      background: var(--primary);
      color: white;
    }
    .result-card {
      background: var(--card);
      border-radius: 8px;
      padding: 15px;
      border: 1px solid #3331;
      margin-top: 20px;
    }
  </style>

</head>
<body>

<div class="container">

  <button onclick="toggleMode()" class="toggle">üåô / ‚òÄÔ∏è</button>

  <h2>Kalkulator Cicilan (Bunga Bulanan / Tahunan)</h2>

  <label>Harga Barang</label>
  <input type="text" id="harga" oninput="formatRp(this)" placeholder="150.000.000">

  <label>DP</label>
  <input type="text" id="dp" oninput="formatRp(this)" placeholder="20.000.000">

  <label>Suku Bunga</label>
  <input type="number" id="bunga" placeholder="10">

  <label>Jenis Bunga</label>
  <select id="tipeBunga">
    <option value="tahun">Per Tahun</option>
    <option value="bulan">Per Bulan</option>
  </select>

  <label>Tenor</label>
  <select id="tenor">
    <option value="12">1 Tahun</option>
    <option value="24">2 Tahun</option>
    <option value="36">3 Tahun</option>
    <option value="60">5 Tahun</option>
    <option value="84">7 Tahun</option>
  </select>

  <button onclick="hitung()">Hitung Cicilan</button>

  <div id="summary" class="result-card" style="display:none;"></div>
  <div id="detail"></div>

</div>

<script>
function toggleMode() {
  document.body.classList.toggle("dark");
}

function formatRp(input) {
  let v = input.value.replace(/\D/g, "");
  input.value = new Intl.NumberFormat("id-ID").format(v);
}

function toNumber(str) {
  return parseFloat(str.replace(/\./g, "")) || 0;
}

function format(v) {
  return new Intl.NumberFormat("id-ID").format(v.toFixed(0));
}

function hitung() {
  const harga = toNumber(document.getElementById("harga").value);
  const dp = toNumber(document.getElementById("dp").value);
  const bunga = parseFloat(document.getElementById("bunga").value) / 100;
  const tipeBunga = document.getElementById("tipeBunga").value;
  const tenor = parseInt(document.getElementById("tenor").value);

  const pinjaman = harga - dp;

  // hitung bunga bulanan sesuai pilihan user
  let bungaBulanan = 0;
  if (tipeBunga === "tahun") {
    bungaBulanan = bunga / 12;
  } else {
    bungaBulanan = bunga;
  }

  // anuitas
  const cicilanBulanan = (pinjaman * bungaBulanan) / (1 - Math.pow(1 + bungaBulanan, -tenor));

  let sisa = pinjaman;
  let totalBunga = 0;

  let table = `
    <table>
      <tr>
        <th>Bulan</th>
        <th>Cicilan</th>
        <th>Pokok</th>
        <th>Bunga</th>
        <th>Sisa</th>
      </tr>
  `;

  for (let i = 1; i <= tenor; i++) {
    const bungaPerBulan = sisa * bungaBulanan;
    const pokok = cicilanBulanan - bungaPerBulan;
    sisa -= pokok;
    totalBunga += bungaPerBulan;

    table += `
      <tr>
        <td>${i}</td>
        <td>Rp ${format(cicilanBulanan)}</td>
        <td>Rp ${format(pokok)}</td>
        <td>Rp ${format(bungaPerBulan)}</td>
        <td>Rp ${format(Math.max(sisa, 0))}</td>
      </tr>
    `;
  }

  table += `</table>`;

  document.getElementById("summary").style.display = "block";
  document.getElementById("summary").innerHTML = `
    <h3>Ringkasan</h3>
    <p><b>Pinjaman:</b> Rp ${format(pinjaman)}</p>
    <p><b>Cicilan / bulan:</b> Rp ${format(cicilanBulanan)}</p>
    <p><b>Total Bunga:</b> Rp ${format(totalBunga)}</p>
    <p><b>Total Pembayaran:</b> Rp ${format(totalBunga + pinjaman)}</p>
  `;

  document.getElementById("detail").innerHTML = `<h3>Rincian Per Bulan</h3>${table}`;
}
</script>

</body>
</html>